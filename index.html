<!DOCTYPE html>
<html>
    <head>
        <!-- En-tÃªte de la page -->
        <meta charset="utf-8" />
        <link rel="stylesheet" href="header.css" />
        <link rel="stylesheet" href="index.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>


        <title>WebSem 3000 : Le moteur de recherche des vrais bonhommes</title>

    </head>

    <body>
    	<div id="logo">
    		<h1>WebSem 3000</h1>
    		Le moteur de recherche des vrais bonhommes
            <input id="req" type="text" placeholder="Ne tapez pas votre recherche ici..."/><input id="submit" type="button" value="Rechercher"/>

    	</div>

    	<div id="listeResultat">
            <a href="http://sdlbsdflhsdblsd">http://www.le-lien.fdsqlibgsdly</a>




<br><br><br><br><br><br><br><br><br><br><br><br>

    	</div>

	    	

    </body>

    <script type="text/javascript">

        $('#submit').click(function(){
            var req = $('#req').val();
            loadXMLDoc(req);
            alert("testFIN");
        });


        function loadXMLDoc(search)
        {
            var request=new XMLHttpRequest();
            request.open("POST","http://localhost:4500/search",false);

            request.send(search); // bloquant
            traitement(request.responseText);
        }

        function traitement(text){
            var lines = text.split('\n');
            for(var i = 0;i < lines.length;i++){
                //code here using lines[i] which will give you each line
                var url = lines[i];
                $('#listeResultat').append('<div class="resultat"><span class="name">'+getNameURL(url)+'</span><br>');
                $('#listeResultat').append('<span class="url">'+url+'</span></div>');
            }

        }

        function getNameURL(url){
            $.ajax({
                url: url,
                success: function(responseHtml) {
                    var newTitle = $(responseHtml).filter('title').text();
                    return newTitle;
                },
                error: function(  jqXHR, textStatus, errorThrown ) {
                    console.log( jqXHR+', & '+textStatus+', & '+errorThrown );
                    return "Pas de titre";
                }
            });
        }

            

    </script>

</html>